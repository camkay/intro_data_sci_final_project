---
title             : "Internet and Social Media Use in American Adults"
shorttitle        : "Internet and Social Media"

author: 
  - name          : "Cameron S. Kay"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "1451 Onyx Street, Eugene, OR 97403"
    email         : "ckay@uoregon.edu"
  - name          : "Stefania R. Ashby"
    affiliation   : "1"
  - name          : "Ashley L. Miller"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "University of Oregon"

abstract: | 
    The present study examined individual differences in interactions with social media content and media consumption in American adults. Secondary data analyses were conducted using an early 2018 phone survey collected by the @Pew. Results showed that older age was associated with lower social media use overall, but these age-related differences varied across social media sites. That is, age-related differences were largest with respect to Snapchat and Twitter use relative to Facebook use. Male respondents also reported less frequency of social media use overall but exhibitted greater use of both Twitter and YouTube than female respondents. Examination of media consumption revealed that both age and media format are significant predictors of the volume of media consumption. Older respondents were reading more than younger respondents, and books in print were read less than those in electronic formats. A marginal interaction between age and media format suggests that the amount of media consumed increases with age more for individuals using exclusively electronic or audiobook formats than fror those using exclusively print or mixed media formats. 

  
keywords          : "social media use, internet attitudes, media format, age, sex, pew research center"

bibliography      : ["r-references.bib"]

floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no
toc               : no 
figsintext        : no #Plots will be referenced at end
header-includes   :  
  - \raggedbottom  
  - \setlength{\parskip}{0pt} #Equations are now left-aligned
documentclass     : "apa6"
classoption       : "man, fleqn, noextraspace" #Odd spacing around paragraphs and headers is removed
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
# knit settings
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE,
                      fig.width = 6.5,
                      fig.height = 8.0)

# turn off scientific notation
options(scipen = 999) 

# if you do not have the following packages, you will need to install them
#install.packages("car")
#install.packages("papaja")
#install.packages("tidyverse")
#install.packages("lme4")
#install.packages("lmerTest")
#install.packages("here")
#install.packages("rio")
#install.packages("lubridate")
#install.packages("cowplot")
#install.packages("wesanderson")
#install.packages("forcats")
#install.packages("pander")
#install.packages("magrittr")
#install.packages("Hmisc")
#install.packages("sjstats")
#install.packages("emmeans")
#install.packages("plotrix")
#install.packages("sjstats")

# load required libraries
library(car)
library(papaja)
library(tidyverse)
library(lme4)
library(lmerTest)
library(here)
library(rio)
library(lubridate)
library(cowplot)
library(wesanderson)
library(forcats)
library(pander)
library(magrittr)
library(Hmisc)
library(sjstats)
library(emmeans)
library(plotrix)
library(sjstats)

# Load required functions
source(here::here("functions", "numbers2words.R")) #writes out a number; found on github from James Fox (https://github.com/ateucher/useful_code/blob/master/R/numbers2words.r)
source(here::here("functions", "perble.R")) #creates a table but with percentages
source(here::here("functions", "spround.R")) #combines round and sprintf
```


```{r prep_data, include = FALSE}
# import data
df <- import(here::here("data", "dataSPSS.sav"), setclass = "tibble") %>%
  janitor::clean_names()

# characterize all columns except for age and books1 (the spss labels were causing the numeric values to be recorded as NAs for those columns)
df %<>%
  mutate_at(vars(-age, -books1), characterize)

#switch 99 ages with refused
df %<>%
  mutate(age = replace(age, age == 99, NA))

# select only variables of interest
df_td <- df %>% 
  select(-comp, 
         -state:-qs1,
         -intmob,
         -home4nw:-device1d,
         -web1f:-web1h, #dropped because we don't have frequency values
         -pial5a:-pial5d,
         -pial11a:-pial11_igbm,
         -marital:-racem4,
         -birth_hisp,
         -partyln:-cellweight) %>%
  # parse date for interview date column
  mutate(int_date = ymd(int_date)) %>% 
  # remove participants who do not occasionally use the internet or email
  filter(eminuse == "Yes") %>%
  select(-eminuse)
  
# over-gather the sns_use and sns_freq_use columns, and spread them back out
df_td %<>%
  gather(key = "websites", value = "value", starts_with("sns"), starts_with("web")) %>%
  separate(websites, into = c("temp", "website"), sep = "[[:digit:]]") %>%
  spread(key = "temp", value = "value")

# change "no, do not do this" in the sns_use column to "Rarely if ever" in the sns_freq_use columns
df_td[which(df_td[, "web"] == "No, do not do this"), "sns"] <- "Rarely if ever"

#drop now unneeded sns_use column
df_td %<>%
  select(-web) %>% 
  #rename the values in the website column
  mutate(website = recode(website, a = "Twitter",
                                   b = "Instagram",
                                   c = "Facebook",
                                   d = "Snapchat",
                                   e = "YouTube")) %>% 
  #rename poorly named columns for sanity
  rename(id = respid,
         date = int_date,
         int_use_freq = intfreq,
         int_good_society = pial11,
         int_good_self = pial12,
         total_books_read = books1,
         books_print = books2a,
         books_audio = books2b,
         books_elect = books2c,
         race = racecmb,
         income = inc,
         sns_freq_use = sns,
         sns = website) %>% 
#convert factors to factors
  mutate(books_print = factor(books_print),
         books_audio = factor(books_audio),
         books_elect = factor(books_elect),
         sex = factor(sex),
         race = factor(race),
         party = factor(party),
         sns = factor(sns),
         int_good_society = factor(int_good_society),
         int_good_self = factor(int_good_self),
         int_use_freq = factor(int_use_freq),
         sns_freq_use = factor(sns_freq_use)) %>% 
  mutate(int_good_self    = fct_recode(int_good_self,
                                       "Bad" = "Bad thing",
                                       "Good" = "Good thing",
                                       "Some of both" = "(VOL) Some of both",
                                       "Other" = "(VOL) Don't know",
                                       "Other" = "(VOL) Refused"),
         int_good_society = fct_recode(int_good_society,
                                       "Bad" = "Bad thing",
                                       "Good" = "Good thing",
                                       "Some of both" = "(VOL) Some of both",
                                       "Other" = "(VOL) Don't know",
                                       "Other" = "(VOL) Refused"),
         party            = fct_recode(party,
                                       "Other" = "(VOL) Other party",
                                       "Other" = "(VOL) Don't know",
                                       "Other" = "(VOL) No preference",
                                       "Refused" = "(VOL) Refused"),
         race             = fct_recode(race,
                                       "Asian" = "Asian or Asian-American",
                                       "Black" = "Black or African-American",
                                       "Other" = "Or some other race",
                                       "Mixed" = "Mixed Race")) %>% 
  mutate(int_good_society = factor(int_good_society, 
                                   levels = c("Other", 
                                               "Bad", 
                                               "Some of both", 
                                               "Good")),
         int_good_self    = factor(int_good_self, 
                                   levels = c("Other", 
                                              "Bad", 
                                              "Some of both", 
                                              "Good")),
         int_use_freq     = factor(int_use_freq, 
                                   levels = c("(VOL) Don't know", 
                                              "Less often?", 
                                              "Several times a week, OR", 
                                              "About once a day", 
                                              "Several times a day", 
                                              "Almost constantly")),
         sns_freq_use     = factor(sns_freq_use,
                                   levels = c("(VOL) Don't know",
                                              "Rarely if ever",
                                              "Less often",
                                              "Every few weeks",
                                              "A few times a week", 
                                              "About once a day", 
                                              "Several times a day")))


```

Social media sites are commonly defined as an internet-based service allowing for the creation and broadcast of user-generated information [@Boyd2008; @Kaplan2010; @Obar2015]. @Obar2015 emphasize the user-generated aspect of this definition, arguing that this content is the lifeblood of social media. Although that may sound hyperbolic, it logically follows that if a site is created with the express purpose of providing user-generated content, it must have user-generated content to function as intended. By way of illustration, without videos created by users, YouTube, a social media site that allows its users to upload and share videos, would fail to serve its primary purpose. Netflix, a site that allows users to only stream videos, does not require user-generated content, as it does not serve user-generated content, and, by extension is not a social media site. Beyond the functional aspects of social media sites, the user-generated focus also highlights the importance of individual differences in the user-service relationship, as users invariably have characteristics that affect how they consume and generate content.

Moreover, in an increasingly internet-based world, many new formats for media consumption have come forward. The days of reading the morning paper as the only source of world news are gone; rather, the internet provides a myriad of other media formats from which to choose. With increasing usage of digital media formats in recent years, there has been a growing interest in whether or not the format of media consumption relates to how well information is learned and retained [@DeZee2005; @Margolin2013; @Delgado2018]. @DeZee2005 found that students in their third year of a medical clerkship did not show any performance differences regardless of whether they chose to use electronic or print resources as their primary method of study. However, a meta-analysis by @Delgado2018 found that paper-based reading may result in better comprehension than digital-based reading. Inconsistent findings from prior work highlights the importance of understanding individual differences in media consumption and choices to interact with media in various formats.

To explore these individual differences in how people both generate social media content and consume media in general, we conducted secondary data analyses using recent survey data collected by the @Pew. First, we examined how frequency of social media use might vary as a function of sex, age, and social media site. Second, we examined relationships between age and media format and how these two factors may predict the volume of media consumption.

# Method

As stated above, survey data examining attitudes towards technology and use of technology and social media was collected by the @Pew. For the current study, we conducted a secondary data analysis looking at factors that relate to frequency of social media use, as well as factors that relate to overall media consumption.

## Participants

`r capitalize(.numbers2words(nrow(df)))` people were surveyed by telephone (`r .spround(.perble(df$sample)["Percent", "Cell phone"])`% cell phone; `r .spround(.perble(df$sample)["Percent", "Landline"])`% landline) over a period of `r interval(min(df_td$date), max(df_td$date)) %/% days(1)` days in `r unique(months(df_td$date))` of `r unique(year(df_td$date))`. We excluded any participants who reported that they do not even occasionally use the internet or email (*n* = `r nrow(df) - length(unique(df_td$id))`). The resulting sample comprised `r length(unique(df_td$id))` people (`r .spround(.perble(df_td$sex)["Percent", "Female"])`% female). Ages ranged from `r min(df_td$age, na.rm = TRUE)` to `r max(df_td$age, na.rm = TRUE)` (*M* age = `r .spround(mean(df_td$age, na.rm = TRUE))`; *SD* age = `r .spround(sd(df_td$age, na.rm = TRUE))`)\footnote{Note that the descriptive statistics for age are slightly lower than reality. Ages 97 and older were recorded as simply 97 in the data.}. Concerning race, `r .spround(.perble(df_td$race)["Percent", "White"])`% identified as white, `r .spround(.perble(df_td$race)["Percent", "Black"])`% identified as black, `r .spround(.perble(df_td$race)["Percent", "Asian"])`% identified as Asian, `r .spround(.perble(df_td$race)["Percent", "Mixed"])`% identified as mixed race, and `r .spround(.perble(df_td$race)["Percent", "Don't know/Refused (VOL.)"] + .perble(df_td$race)["Percent", "Other"])`% refused to answer or reported being from some other race.  

## Materials and Procedure

Research personnel were instructed to read from a script while interviewing each participant. For landline users, the script began as follows: "Hello, I am _____ calling on behalf of the Pew Research Center. We are conducting a telephone opinion survey about some important issues today and we would like to include your household. May I please speak with the YOUNGEST [RANDOMIZE: (MALE / FEMALE)], age 18 or older, who is now at home? [IF NO MALE/FEMALE, ASK: May I please speak with the YOUNGEST (FEMALE / MALE), age 18 or older, who is now at home?]"

For cell phone users, the script was slightly different: "Hello, I am _____ calling on behalf of the Pew Research Center. We are conducting a telephone opinion survey about some important issues today. I know I am calling you on a cell phone. If you would like to be reimbursed for your cell phone minutes, we will pay all eligible respondents $5 for participating in this survey. This is NOT a sales call."

Once participants passed initial screening (e.g., 18 years of age or older) and provided verbal consent to the interview, they were asked a series of questions pertaining to internet use  (e.g., "How often do you use the internet?"; options ranged from 1 = "Almost Constantly" to 5 = "Less Often"), social media use (e.g., "Do you use any of the following social media sites online or on your cell phone: Twitter, Instagram, Facebook, Snapchat, YouTube, WhatsApp, Interest, and LinkedIn?"), as well as perceptions of social media's influence on the self and society (e.g., "When you add up all the advantages and disadvantages of the internet, would you say the internet has mostly been a good thing or a bad thing for society?"; options included: "Good Thing", "Bad Thing", "Some of Both", and "Don't Know"). Participants were also asked about reading habits (e.g., "During the past 12 months, how many books (print, electronic, and audiobooks) did you read either all or part of the way through?") and reading format preferences (e.g., "Thinking about all of the books you have read in the past 12 months, were any of those printed books, audiobooks, or E-books?"). The interview ended with a series of demographic questions assessing variables including participant sex, age, race, marrital status, education, current employment status, income, and political affiliation.

## Data analysis
Data was analyzed using `r cite_r("r-references.bib")` for all our analyses.

# Results

First, we sought to examine how frequency of social media use might vary as a function of sex, age, social media site, and the interaction between these variables. Using the *lme4* package by [@R-lme4], we ran a comparison of seven linear mixed-effects models predicting frequency of social media use from age, social media site, sex, and the interactions among these variables. Our first model included only the random effects. Specifically, we suspected that participants may have certain response style in evaluating their frequency of social media use. We entered the subject as a random intercept to account for interdependence in the participants' ratings. Although in many cases the scenario or context (i.e., social media site) would be entered as a random slope, we did not wish to generalize beyond these sites. Our second model added gender, followed by age in our third model. The fourth model included the social media site in question. The fifth through seventh models added (1) the interaction between sex and age, (2) the interaction between sex and social media site, and (3) the interaction between age and social media site. 

```{r df_lmer, include = FALSE}
#remove unknowns and "rarely if ever and change sns_freq_use to numeric
df_td_lmer <- df_td %>%
  filter(sns_freq_use != "(VOL) Don't know",
         #rarely if ever was leading to blocky residuals
         sns_freq_use != "Rarely if ever",
         !is.na(sns_freq_use),
         !is.na(age)) %>%
  mutate(sns_freq_use = as.numeric(sns_freq_use))

#NULL
model_null <- lmer(sns_freq_use ~ (1 | id), data = df_td_lmer, REML = FALSE)

#sex
model_1    <- lmer(sns_freq_use ~ sex + 
                                  (1 | id), data = df_td_lmer, REML = FALSE)

#age
model_2    <- lmer(sns_freq_use ~ sex + 
                                  age +
                                  (1 | id), data = df_td_lmer, REML = FALSE)

#sns
model_3    <- lmer(sns_freq_use ~ sex + 
                                  age +
                                  sns +
                                  (1 | id), data = df_td_lmer, REML = FALSE)


#sex x age
model_4    <- lmer(sns_freq_use ~ sex + 
                                  age +
                                  sns +
                                  sex * age +
                                  (1 | id), data = df_td_lmer, REML = FALSE)

#sex x sns
model_5    <- lmer(sns_freq_use ~ sex + 
                                  age +
                                  sns +
                                  sex * age +
                                  sex * sns +
                                  (1 | id), data = df_td_lmer, REML = FALSE)

#age x sns
model_6    <- lmer(sns_freq_use ~ sex + 
                                  age +
                                  sns +
                                  sex * age +
                                  sex * sns +
                                  age * sns +
                                  (1 | id), data = df_td_lmer, REML = FALSE)

#compare models
(models_compared <- anova(model_null,
                          model_1,
                          model_2,
                          model_3,
                          model_4,
                          model_5,
                          model_6))

#compare model without random effects to that with random effects
model_wo <- lm(sns_freq_use ~ sex + 
                              age +
                              sns +
                              sex * age +
                              sex * sns +
                              age * sns, data = df_td_lmer)

(wo_compared <- anova(model_6, model_wo))

###plot residuals
plot(resid(model_6))
qqnorm(resid(model_6))
qqline(resid(model_6))

###check out VIF
(model_vif <- vif(model_3))

#check out full model results
(sum_model_6 <- summary(model_6))

#get betas
(sum_model_6_betas <- std_beta(model_6))
rownames(sum_model_6_betas) <- sum_model_6_betas$term

#check out the variances
model_var <- print(VarCorr(model_6), comp = "Variance")
(model_var <- data.frame(model_var)[, c("grp", "vcov")])

#check out contrasts
#emm_options(pbkrtest.limit = nrow(df_td_lmer))
#emms_results <- emmeans(model_6, ~ sns | sex)
#(emms_contrast <- contrast(emms_results, interaction = "pairwise"))
```


As shown in Table 1, we found that the addition of age, social media site, the interaction between sex and social media site, and the interaction between age and social media site all explained a significant proportion of variance in social media site usage frequency. Using the *lmerTest* package from @R-lmerTest to approximate degrees of freedom with Satterthwaite's method, we found that age is associated with lower social media use, $\beta$ = `r .spround(sum_model_6_betas["age", "std.estimate"], l_zero = FALSE)`, *SE* = `r .spround(sum_model_6_betas["age", "std.error"], l_zero = FALSE)`, *p* = `r .spround(sum_model_6$coefficients["age", "Pr(>|t|)"], 3, l_zero = FALSE)` (see Figure 1c). Furthermore, Snapchat is used more often than Facebook ($\beta$ = `r .spround(sum_model_6_betas["snsSnapchat", "std.estimate"], l_zero = FALSE)`, *SE* = `r .spround(sum_model_6_betas["snsSnapchat", "std.error"], l_zero = FALSE)`, *p* < `r .spround(sum_model_6$coefficients["snsSnapchat", "Pr(>|t|)"], 3, l_zero = FALSE)`) and Twitter is used more often than Facebook ($\beta$ = `r .spround(sum_model_6_betas["snsTwitter", "std.estimate"], l_zero = FALSE)`, *SE* = `r .spround(sum_model_6_betas["snsTwitter", "std.error"], l_zero = FALSE)`, *p* < `r .spround(sum_model_6$coefficients["snsTwitter", "Pr(>|t|)"], 3, l_zero = FALSE)`). However, age interacts with the specific social media site, insofar that age results in even lower rates of social media use in the case of Instagram ($\beta$ = `r .spround(sum_model_6_betas["age:snsInstagram", "std.estimate"], l_zero = FALSE)`, *SE* = `r .spround(sum_model_6_betas["age:snsInstagram", "std.error"], l_zero = FALSE)`, *p* < `r .spround(sum_model_6$coefficients["age:snsInstagram", "Pr(>|t|)"], 3, l_zero = FALSE)`), Snapchat ($\beta$ = `r .spround(sum_model_6_betas["age:snsSnapchat", "std.estimate"], l_zero = FALSE)`, *SE* = `r .spround(sum_model_6_betas["age:snsSnapchat", "std.error"], l_zero = FALSE)`, *p* < `r .spround(sum_model_6$coefficients["age:snsSnapchat", "Pr(>|t|)"], 3, l_zero = FALSE)`), Twitter ($\beta$ = `r .spround(sum_model_6_betas["age:snsTwitter", "std.estimate"], l_zero = FALSE)`, *SE* = `r .spround(sum_model_6_betas["age:snsTwitter", "std.error"], l_zero = FALSE)`, *p*= `r .spround(sum_model_6$coefficients["age:snsTwitter", "Pr(>|t|)"], 3, l_zero = FALSE)`), and YouTube ($\beta$ = `r .spround(sum_model_6_betas["age:snsYouTube", "std.estimate"], l_zero = FALSE)`, *SE* = `r .spround(sum_model_6_betas["age:snsYouTube", "std.error"], l_zero = FALSE)`, *p* < `r .spround(sum_model_6$coefficients["age:snsYouTube", "Pr(>|t|)"], 3, l_zero = FALSE)`) when compared to Facebook. 

Although the model comparison did not indicate an increase in predictive ability from the introduction of participant gender, we did find that males (in comparison to females) reported less frequency of social media use when using the approximated degrees of freedom, $\beta$ = `r .spround(sum_model_6_betas["sexMale", "std.estimate"], l_zero = FALSE)`, *SE* = `r .spround(sum_model_6_betas["sexMale", "std.error"], l_zero = FALSE)`, *p* = `r .spround(sum_model_6$coefficients["sexMale", "Pr(>|t|)"], 3, l_zero = FALSE)`. When compared to Facebook, however, men exhibitted a greater frequency of using Twitter ($\beta$ = `r .spround(sum_model_6_betas["sexMale:snsTwitter", "std.estimate"], l_zero = FALSE)`, *SE* = `r .spround(sum_model_6_betas["sexMale:snsTwitter", "std.error"], l_zero = FALSE)`, *p* < `r .spround(sum_model_6$coefficients["sexMale:snsTwitter", "Pr(>|t|)"], 3, l_zero = FALSE)`) and YouTube ($\beta$ = `r .spround(sum_model_6_betas["sexMale:snsYouTube", "std.estimate"], l_zero = FALSE)`, *SE* = `r .spround(sum_model_6_betas["sexMale:snsYouTube", "std.error"], l_zero = FALSE)`, *p* < `r .spround(sum_model_6$coefficients["sexMale:snsYouTube", "Pr(>|t|)"], 3, l_zero = FALSE)`) than women did.  

A comparison of the full model with random effects to the full model without random effects, revealed that the random effects explained a significant proportion of the variance in social media site use, $\chi^2$(`r .spround(wo_compared[2, "Chi Df"], 0)`) = `r .spround(wo_compared[2, "Chisq"], 2)`, *p* < `r .spround(wo_compared[2, "Pr(>Chisq)"], 3, l_zero = FALSE)`. In fact, grouping ratings by participant explained `r .spround((model_var[1, "vcov"]/sum(model_var$vcov)) * 100)`% of the variance in the frequency of using a social media site. A visual inspection of model residuals suggested a slight negative skew, but no heteroscedasticity. We also quantitively inspected the variables for potential multicollinearity within the fullest model without the interaction effects. No multicollinearity was detected (*VIF* = `r min(model_vif[, "GVIF"])` - `r max(model_vif[, "GVIF"])`). 

```{r df_lmer_table, echo = FALSE, results = "asis"}
###clean table names
models_compared <- models_compared %>%
  janitor::clean_names()

###round
#create na identified function
na_id <- function(data = NULL, col = NULL) {
  !is.na(data[, col])
}

models_compared[na_id(models_compared, "pr_chisq"), 
                "pr_chisq"] <- .spround(models_compared[na_id(models_compared,
                                                             "pr_chisq"), 
                                                       "pr_chisq"], 
                                        3, 
                                        l_zero = FALSE)


models_compared[na_id(models_compared, "chi_df"), 
                "chi_df"] <- .spround(models_compared[na_id(models_compared,
                                                             "chi_df"), 
                                                       "chi_df"], 0)


models_compared[na_id(models_compared, "chisq"), 
                "chisq"] <- .spround(models_compared[na_id(models_compared,
                                                             "chisq"), 
                                                       "chisq"], 2)


models_compared$log_lik <- .spround(models_compared$log_lik, 2)

models_compared$df <- .spround(models_compared$df, 0)

###replace nas
for (i in 1:nrow(models_compared)) {
  for (j in 1:ncol(models_compared)) {
    if (is.na(models_compared[i, j])) {
      models_compared[i, j] <- ""
    } else if (models_compared[i, j] == ".001") {
      models_compared[i, j] <- "<.001"
    }
  }
}

###cut down table
models_compared %<>%
  select(df,
         chi_df,
         log_lik,
         chisq,
         pr_chisq)

###clean up table namees
rownames(models_compared) <- c("Null", 
                               "Sex", 
                               "Age",
                               "SNS",
                               "Sex X Age",
                               "Sex X SNS",
                               "Age X SNS")

colnames(models_compared) <- c("\\textit{K}",
                               "$\\chi^2$ \\textit{df}",
                               "Loglik.",
                               "$\\chi^2$", 
                               "\\textit{p}")

models_compared_note <- paste("Participant \\textit{N} = ", sum_model_6$ngrps[[1]], "; Social Network Site \\textit{N} = ", length(unique(df_td_lmer$sns)), ". Null model includes only the random intercept. SNS = social network site. X indicates an interaction.", sep = "")

###print table
models_compared %>%
 apa_table(caption = "Log likelihood comparison of linear mixed-effects models predicting social network site use from sex, age, and specific social network site.",
           note = models_compared_note,
           escape = FALSE,
           align = "lrrrrr")

```

```{r cleanup_results_df_f, include = FALSE}
rm(list = setdiff(ls(), c("df", "df_td")))
```


```{r fig1, fig.width = 6.5, fig.height = 5.5, fig.cap="Frequency of social media use as a function of (a) the interaction between age and social media site, (b) social media site alone, and (c) age alone." }

plot_data_ash <- df_td %>% 
  select(age, sex, party, sns, sns_freq_use, int_good_society, int_good_self, int_use_freq) %>%
  mutate(int_good_self = as.numeric(int_good_self),
         int_good_society = as.numeric(int_good_society),
         int_use_freq = as.numeric(int_use_freq),
         sns_freq_use = as.numeric(sns_freq_use)) %>%
  filter(party != "Refused",
         sns_freq_use != "<NA>",
         sns_freq_use != "(VOL) Don't know")

#Examining frequency of social media use as a function of age and social media site

fig1a <- ggplot(transform(plot_data_ash,
                          sns = factor(sns,levels = c("Facebook", "YouTube", "Instagram", "Snapchat", "Twitter")))) +
  geom_smooth(aes(x = age, y = sns_freq_use, group = sns, colour = sns), method = "lm", se = TRUE, lwd = 1.5) +
  scale_colour_viridis_d() +
  theme_bw() +
  labs(#title = "Interaction between age and social media site",
       x = "Age", 
       y = "Social Media Use Freq",
       colour = "Social Media Site") +
  theme(plot.title = element_text(size = 11, hjust = 0, family = "Times"),
        axis.title.x = element_text(size = 9, family = "Times"), 
        axis.title.y = element_text(size = 9, family = "Times"),
        axis.text = element_text(size = 9, family = "Times"),
        legend.text = element_text(family = "Times"),
        legend.title = element_text(family = "Times", size = 10),
        strip.text = element_text(family = "Times"))

plot_sns <- plot_data_ash %>%
  group_by(sns) %>%
  summarise(freq_sns_mean = mean(sns_freq_use)) 

fig1b <- ggplot(transform(plot_sns,
                          sns = factor(sns,levels = c("Facebook", "YouTube", "Instagram", "Snapchat", "Twitter")))) +
    geom_col(aes(x = sns, y = freq_sns_mean, fill = sns)) +
    scale_fill_viridis_d() +
    theme_bw() +
    theme(legend.position = "",
          axis.text.x = element_text(angle = 75, vjust = .5, family = "Times"),
          plot.title = element_text(size = 11, hjust = 0, family = "Times"),
          axis.title.x = element_text(size = 9, family = "Times"), 
          axis.title.y = element_text(size = 9, family = "Times"),
          axis.text = element_text(size = 9, family = "Times")) +
    labs(#title = "Main effect of social media site",
        x = "Social Media Site",
        y = "Social Media Use Freq",
        colour = "")

fig1c <- plot_data_ash %>%
  group_by(age) %>%
  summarise(freq_sns_mean = mean(sns_freq_use, fill = age)) %>%
  ggplot(aes(x = age, y = freq_sns_mean)) +
    geom_point(alpha = 0.9, fill = "turquoise3", color = "turquoise4", size = 2) +
    geom_smooth(color = "grey", method = lm, se = FALSE) +
    theme_bw() +
    theme(legend.position = "",
          plot.title = element_text(size = 11, hjust = 0, family = "Times"),
          axis.title.x = element_text(size = 9, family = "Times"), 
          axis.title.y = element_text(size = 9, family = "Times"),
          axis.text = element_text(size = 9, family = "Times")) +
    labs(#title = "Main effect of age",
        x = "Age",
        y = "Social Media Use Freq")

fig1d <- plot_grid(fig1b, fig1c, labels = c("B", "C"), align = "h", ncol = 2)

Figure1 <- plot_grid(fig1a, fig1d, labels = c("A", ""), align = "v", axis = "t", nrow = 2)

Figure1

```

```{r fig2, fig.width = 6.5, fig.height = 5.5, fig.cap="Frequency of social media use as a function of (a) the (non-significant) three-way interaction between age, sex, and social media site, (b) the interaction between sex and social media site, and (c) sex alone" }

#Examing the potential influence of sex on the aforementioned effects

fig2a <- ggplot(transform(plot_data_ash, 
                 sns = factor(sns,levels = c("Facebook", "YouTube", "Instagram", "Snapchat", "Twitter")))) +
  geom_smooth(aes(x = age, y = sns_freq_use, group = sex, colour = sex), method = "lm", se = TRUE, lwd = 1.5) +
  scale_color_manual(values = c("turquoise4", "darkorchid4")) +
  geom_jitter(aes(x = age, y = sns_freq_use, colour = sex), alpha = 0.15, size = 0.5) +
  facet_wrap(~sns, nrow = 1) +
  theme_bw() +
  theme(plot.title = element_text(size = 11, hjust = 0, family = "Times"),
        axis.title.x = element_text(size = 9, family = "Times"), 
        axis.title.y = element_text(size = 9, family = "Times"),
        axis.text = element_text(size = 9, family = "Times"),
        legend.text = element_text(family = "Times"),
        legend.title = element_text(family = "Times", size = 10),
        strip.text = element_text(family = "Times")) +
  labs(#title = "Interaction between sex, age, and social media site",
       x = "Age", 
       y = "Social Media Use Freq",
       colour = "Sex")

plot_snsxsex <- plot_data_ash %>%
  group_by(sex, sns) %>%
  summarise(freq_sns_mean = mean(sns_freq_use))

fig2b <- ggplot(transform(plot_snsxsex,
                                 sns = factor(sns,levels = c("Facebook", "YouTube", "Instagram", "Snapchat", "Twitter")))) +
    geom_col(aes(x = sex, y = freq_sns_mean, group = sex, fill = sex)) +
    scale_fill_manual(values = c("turquoise4", "darkorchid4")) +
    facet_wrap(~sns, nrow = 1) +
    theme_bw() +
    theme(legend.position = "",
          axis.text.x = element_text(angle = 75, vjust = .5, family = "Times"),
          plot.title = element_text(size = 10.5, hjust = 0, family = "Times"),
          strip.text = element_text(size = 8, family = "Times"),
          axis.title.x = element_text(size = 9, family = "Times"), 
          axis.title.y = element_text(size = 9, family = "Times"),
          axis.text = element_text(size = 9, family = "Times")) +
    labs(#title = "Interaction between sex and social media site",
       x = "Sex", 
       y = "Social Media Use Freq",
       colour = "Sex")

fig2c <- plot_data_ash %>%
  ggplot(aes(x = sex, y = sns_freq_use)) +
    geom_boxplot(aes(group = sex, fill = sex)) +
    scale_fill_manual(values = c("turquoise4", "darkorchid4")) +
    theme_bw() +
    theme(legend.position = "",
          plot.title = element_text(size = 11, hjust = 0, family = "Times"),
          axis.title.x = element_text(size = 9, family = "Times"), 
          axis.title.y = element_text(size = 9, family = "Times"),
          axis.text = element_text(size = 9, family = "Times")) +
    labs(#title = "Main effect of sex",
       x = "Sex", 
       y = "Social Media Use Freq")

fig2d <- plot_grid(fig2b, fig2c, labels = c("B", "C"), align = "h", ncol = 2)

Figure2 <- plot_grid(fig2a, fig2d, labels = c("A", ""), align = "v", axis = "t", nrow = 2)

Figure2


```


```{r books_analyses, include = FALSE, warning = FALSE}
#####################################
### Tidying Data for Analyses:

# Subset the original data and tidy for plotting, added age_group variable and recoded
book_data <- df_td %>% 
  select(id, age, total_books_read, books_print, books_audio, books_elect) %>% 
  filter(!duplicated(id) & !is.na(age)) %>% # Remove duplicate id's so we have one observation per subject
  gather(book_format, yn, -age, -total_books_read, -id) %>% 
  separate(book_format, c("dis", "book_format"), sep = "_", convert = TRUE) %>% 
  select(-dis) %>%
  mutate(yn = replace(yn, str_detect(yn, 'VOL'), NA)) %>% 
  mutate(book_format = factor(book_format),
         yn = factor(yn),
         age_group = factor(findInterval(age, seq(10, 100, by = 10)))) %>% 
  mutate(age_group = recode(age_group, "1" = "18-19",
                                       "2" = "20-29",
                                       "3" = "30-39",
                                       "4" = "40-49",
                                       "5" = "50-59",
                                       "6" = "60-69",
                                       "7" = "70-79",
                                       "8" = "80-89",
                                       "9" = "90-99"))

#  Build new format column that exclusively represents one type of media format: exclusively print, audiobook, or electronic, plus a mixed-media option for poeple who use more than one type. 
subj <- unique(book_data$id)
book_data$new_format <- NA

# Loop through subjects to populate new_format column which will later replace the book_format column.
for (i in 1:length(subj)) {
  foo <- book_data[book_data$id == subj[i],]
  if (length(which(foo$yn == "Yes")) == 1) {
    book_data$new_format[book_data$id == subj[i]] <- as.character(rep(foo$book_format[foo$yn == "Yes"], 3))
  } else if (length(which(foo$yn == "Yes")) >= 2) {
    book_data$new_format[book_data$id == subj[i]] <- as.character(rep("mixed media", 3))
  }
}

# Replace the book_format column with the new_format column, remove redundant columns (new_format and yn)
book_data %<>%
  select(-book_format) %>%
  mutate(book_format = new_format) %>%
  select(-new_format, -yn) %>%
  filter(!duplicated(id)) %>% # remove duplicate rows
  mutate(book_format = factor(book_format,
                              levels = c("print", "audio", "elect", "mixed media"))) #reorder levels

```

We next sought to examine how media consumption may vary as a function of age as well as media format (i.e. individuals exclusively using print media, audiobooks, electronic media or combinations of the three). To explore this data we used the total number of books read in the past year as an indicator of media consumption. Survey respondents who endorsed only using a single type of media format were grouped into either print, audio, or electronic as appropriate. Respondents who endorsed using more than one type of media format were grouped together into a "mixed media" bin. Next, we calculated the average number of books read, grouped by age and media format (see Figure \@ref(fig:fig4)A). There appear to be age differences in the number of books read as a function of media format. For example, we see that audiobook usage seems to be more prevalent among the older respondents. 

```{r fig3, fig.width=6, fig.height=4, fig.cap="Average books read in the past year grouped by age and media format" }
#####################################
###  Reading and Age Visualization:

# Pick color palette for plot
pal <- wes_palette("Darjeeling1")

# Bar Chart: looking at average books read across age.
fig3a <- book_data %>%
  filter(!is.na(book_format)) %>% 
  group_by(age_group, book_format) %>% 
  dplyr::summarize(mean_books = mean(total_books_read, na.rm = TRUE),
                   se_books = plotrix::std.error(total_books_read, na.rm = TRUE)) %>% 
  ggplot(aes(x = age_group, y = mean_books, fill = book_format)) + 
  geom_col(position = position_dodge(.9)) +
  geom_linerange(aes(ymin = mean_books - se_books, ymax = mean_books + se_books), 
                 width = .2, position = position_dodge(.9)) +
  #scale_y_continuous(expand = c(0, 0)) +
  scale_fill_manual(values = pal) + 
  theme_apa(base_size = 10) +
  labs(y = "Average Books Read",
       x = "Ages",
       fill = "Media Format") +
  theme(plot.subtitle = element_text(size = 10, hjust = 0, 
                                     face = "italic", color = "black"),
        plot.title = element_text(size = 12, hjust = 0),
        axis.title.x = element_text(size = 10), 
        axis.title.y = element_text(size = 10),
        axis.text = element_text(size = 10),
        axis.text.x = element_text(angle = 75, vjust = .5),
        legend.position = "right") 


```

```{r tab2, echo = FALSE, warnings = FALSE, results = "asis"}
#####################################
###  Reading and Age Analysis:
reg_data <- book_data %>% 
  filter(!is.na(book_format)) %>% 
  group_by(age, book_format) %>% 
  dplyr::summarize(mean_books = mean(total_books_read))

# Fit the model
model <- lm(mean_books ~ age * book_format, data = reg_data)
fit_anova <- anova(model)
apa_table(fit_anova, caption = "Main effects of age and media format predicting the average number of books read in 2018.")
anova_results_p <- apa_print(fit_anova, es = "pes", in_paren = TRUE)

# Examine differences by book format, report in-text
sig_test <- pairwise.t.test(reg_data$mean_books, reg_data$book_format, p.adj = "none")
print_audio <- apa_print.htest(t.test(reg_data$mean_books[reg_data$book_format == "print"], reg_data$mean_books[reg_data$book_format == "audio"]))
print_elect <- apa_print.htest(t.test(reg_data$mean_books[reg_data$book_format == "print"], reg_data$mean_books[reg_data$book_format == "elect"]))
audio_elect <- apa_print.htest(t.test(reg_data$mean_books[reg_data$book_format == "audio"], reg_data$mean_books[reg_data$book_format == "elect"]))
print_mixed <- apa_print.htest(t.test(reg_data$mean_books[reg_data$book_format == "print"], reg_data$mean_books[reg_data$book_format == "mixed media"]))
audio_mixed <- apa_print.htest(t.test(reg_data$mean_books[reg_data$book_format == "audio"], reg_data$mean_books[reg_data$book_format == "mixed media"]))
elect_mixed <- apa_print.htest(t.test(reg_data$mean_books[reg_data$book_format == "elect"], reg_data$mean_books[reg_data$book_format == "mixed media"]))
```

To look at the relationships between the average books read in 2018, age, and media format, we ran a multiple regression predicting the average number of books read in the past year from age and media format as well as their interaction (see Figure  \@ref(fig:fig4)B). Results showed a significant main effect of age (`r anova_results_p$full_result$age`) with older adults reading more books in 2018 than younger adults. We also saw a significant main effect of media format (`r anova_results_p$full_result$book_format`) and pairwise comparisons revealed that books in print format were read less than those in electronic (`r print_elect$statistic`) format. We found no difference in the number of books read exclusively in a print format and the number of books read through the audiobook format (`r print_audio$statistic`). However, we did find that more books were read using a mixed media approach than either exclusively print (`r print_mixed$statistic`) or exclusively audiobooks (`r audio_mixed$statistic`). Lastly, we found no difference between media consumed by individuals who reported the used mixed media sources compared to those who exclusively preferred electronic formats (`r elect_mixed$statistic`, see Table \@ref(tab:tab2)). Finally, there was a marginal interaction effect between age and media format where changes in average books read increased with age more for individuals exclusively using electronic formats or audiobooks than for individuals exclusively using print media or a mixed media approach. 

```{r fig4, fig.width=6, fig.height=6, fig.cap="(a) Average books read in the past year grouped by age and media format, (b) Relationships between age and media format predicting average books read in the past year"}
# Scatterplot: looking at average books read by age and media format
pal <- wes_palette("Darjeeling1")

fig3b <- book_data %>%
  filter(!is.na(book_format)) %>% 
  group_by(age, book_format) %>% 
  dplyr::summarize(mean_books = mean(total_books_read, na.rm = TRUE),
                   se_books = plotrix::std.error(total_books_read, na.rm = TRUE)) %>% 
  ggplot(aes(x = age, y = mean_books, color = book_format)) + 
  geom_point(fill = "black") +
  geom_smooth(method = "lm", se = FALSE, aes(color = book_format)) +
  scale_color_manual(values = pal) + 
  theme_apa(base_size = 12) +
  labs(y = "Average Books Read",
       x = "Age",
       color = "Media Format") +
  theme(plot.subtitle = element_text(size = 10, hjust = 0, 
                                     face = "italic", color = "black"),
        plot.title = element_text(size = 12, hjust = 0),
        axis.title.x = element_text(size = 10), 
        axis.title.y = element_text(size = 10),
        axis.text = element_text(size = 10),
        axis.text.x = element_text(angle = 75, vjust = .5),
        legend.position = "right")

plot_grid(fig3a, fig3b, labels = c("A", "B"), align = "v", axis = "t", nrow = 2)

```


# Discussion


\newpage

# References
```{r create_r-references}
r_refs(file = "r-references.bib")
```

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id = "refs"></div>
\endgroup
